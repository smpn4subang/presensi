{"files":[{"id":"d3d8ecae-723c-4b47-8018-738353c546d7","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Jakarta\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  }\n}"},{"id":"d7a77475-67a5-4b5c-b233-aec440ec2096","name":"Code","type":"server_js","source":"const SHEET_ID \u003d \"1tj6S__2HRIefOBYM3CgLjvOVPU4S5CmqF2A5cAqoNlc\";\nconst FOLDER_ID \u003d \"156C1fWY3C-beMhLEJpEx-g5oTrzsWboW\"; // ganti dengan ID folder tempat menyimpan tanda tangan\n\nfunction doGet() {\n  return HtmlService.createHtmlOutputFromFile(\u0027index\u0027);\n}\n\nfunction saveData(data) {\n  const ss \u003d SpreadsheetApp.openById(\"1tj6S__2HRIefOBYM3CgLjvOVPU4S5CmqF2A5cAqoNlc\");\n  const sheet \u003d ss.getActiveSheet();\n\n  // Simpan tanda tangan ke Google Drive\n  const blob \u003d Utilities.newBlob(\n    Utilities.base64Decode(data.ttdUrl.split(\u0027,\u0027)[1]),\n    \u0027image/png\u0027,\n    `${data.nama.replace(/\\s+/g, \u0027_\u0027)}_${new Date().toISOString()}.png`\n  );\n  const folder \u003d DriveApp.getFolderById(\"156C1fWY3C-beMhLEJpEx-g5oTrzsWboW\");\n  const file \u003d folder.createFile(blob);\n  file.setSharing(DriveApp.Access.ANYONE_WITH_LINK, DriveApp.Permission.VIEW);\n\n  const fileUrl \u003d file.getUrl();\n\n  // Simpan semua data ke spreadsheet\n  sheet.appendRow([\n    new Date(),\n    data.nama,\n    data.jabatan,\n    data.kelas,\n    data.jam,\n    data.lokasi,\n    fileUrl\n  ]);\n\n  return \"Absensi berhasil dikirim dan tanda tangan disimpan!\";\n}\n"},{"id":"3529a780-9a24-4d3e-b14b-00c7e781af77","name":"index","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e\n    \u003clink href\u003d\"https://fonts.googleapis.com/css2?family\u003dPoppins:wght@400;600\u0026display\u003dswap\" rel\u003d\"stylesheet\"\u003e\n    \u003cstyle\u003e\n      body {\n        font-family: \u0027Poppins\u0027, sans-serif;\n        background: linear-gradient(to right, #e0f7fa, #ffffff);\n        padding: 0;\n        margin: 0;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n      }\n\n      .logo {\n        width: 120px;\n        display: block;\n        margin: 40px auto 20px;\n      }\n\n      .container {\n        width: 100%;\n        max-width: 520px;\n        background: #ffffff;\n        padding: 35px 30px;\n        border-radius: 16px;\n        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.1);\n      }\n\n      h2 {\n        text-align: center;\n        color: #0d47a1;\n        margin-bottom: 25px;\n        font-size: 24px;\n      }\n\n      label {\n        display: block;\n        margin-top: 15px;\n        margin-bottom: 6px;\n        font-weight: 600;\n        color: #333;\n      }\n\n      select, input[type\u003d\"text\"] {\n        width: 100%;\n        padding: 10px;\n        border: 1px solid #ccc;\n        border-radius: 8px;\n        font-size: 14px;\n      }\n\n      canvas {\n        display: block;\n        margin: 12px auto;\n        border: 1px solid #aaa;\n        border-radius: 8px;\n        background: #fff;\n      }\n\n      .button-group, .footer {\n        text-align: center;\n        margin-top: 20px;\n      }\n\n      button {\n        background-color: #0288d1;\n        color: white;\n        border: none;\n        padding: 10px 20px;\n        margin: 8px 5px;\n        border-radius: 8px;\n        cursor: pointer;\n        font-size: 14px;\n        font-weight: 600;\n        transition: background-color 0.3s;\n      }\n\n      button:hover {\n        background-color: #01579b;\n      }\n\n      .footer {\n        color: #777;\n        font-size: 13px;\n        margin-bottom: 30px;\n      }\n    \u003c/style\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n    \u003cimg src\u003d\"https://drive.google.com/uc?export\u003dview\u0026id\u003d10vcaoYH0201M5OzfUH9jHNFG77ft5TEg\" class\u003d\"logo\"\u003e\n\n    \u003cdiv class\u003d\"container\"\u003e\n      \u003ch2\u003eForm Absensi Guru\u003c/h2\u003e\n\n      \u003clabel\u003eNama Guru:\u003c/label\u003e\n      \u003cselect id\u003d\"nama\"\u003e\n        \u003coption value\u003d\"\"\u003e-- Pilih Guru --\u003c/option\u003e\n        \u003coption\u003eHj. NANI ROHAYATI, S.Pd\u003c/option\u003e\n      \u003coption\u003eCICIH SUMARNI, M.Pd\u003c/option\u003e\n      \u003coption\u003eLIAWATI SUMANTRI, S.Pd\u003c/option\u003e\n      \u003coption\u003eYANI MALAYAWATI, A.Md.Pd\u003c/option\u003e\n      \u003coption\u003eYETI SUMIATI, S.Pd\u003c/option\u003e\n      \u003coption\u003eDrs. DIDIK AZHARI\u003c/option\u003e\n      \u003coption\u003eIDA HIDAYAT, S.Sn\u003c/option\u003e\n      \u003coption\u003eIIN ISNAENI, S.Pd\u003c/option\u003e\n      \u003coption\u003eAI IMAS KOMALASARI, S.Ag,. M.M.Pd\u003c/option\u003e\n      \u003coption\u003eMAULANA ABIDIN, S.Pd\u003c/option\u003e\n      \u003coption\u003eYULIANI, S.Pd\u003c/option\u003e\n      \u003coption\u003eRENI PRATIWI, S.Pd\u003c/option\u003e\n      \u003coption\u003eGALIH MUGGIA, S.Pd\u003c/option\u003e\n      \u003coption\u003eDIKDIK HARDIANA, S.Pd\u003c/option\u003e\n      \u003coption\u003eSITI PARIDAH, S.Ag\u003c/option\u003e\n      \u003coption\u003eCECE SUPRIATNADI, S.Pd\u003c/option\u003e\n      \u003coption\u003eTATANG GUNAWAN, S.Pd\u003c/option\u003e\n      \u003coption\u003eLANGGENG RIZKIYAH, S.Pd\u003c/option\u003e\n      \u003coption\u003eADAM WILLYAM, S.Pd\u003c/option\u003e\n      \u003coption\u003eDIAN MARLIANTI, S.Pd\u003c/option\u003e\n      \u003coption\u003eIDA ROSIDA, S.Pd\u003c/option\u003e\n      \u003coption\u003eBu AT. LAELA SYARI, S.Pd\u003c/option\u003e\n      \u003coption\u003eLILIS ANGKIT RAHAYU, S.Pd\u003c/option\u003e\n      \u003coption\u003eDWI ASTUTI, S.Pd\u003c/option\u003e\n      \u003coption\u003eEMA HERMALIANA, S.T\u003c/option\u003e\n      \u003coption\u003eDALLA KRISTIDY, S.Pd\u003c/option\u003e\n      \u003coption\u003eLUTFI DWI RIZKI, S.Pd\u003c/option\u003e\n      \u003coption\u003ePIFIH SETIAWATI, S.Pd\u003c/option\u003e\n      \u003coption\u003eALZAHRA PRAMANIK, S.Pd\u003c/option\u003e\n      \u003coption\u003eLINA LAYANGSARI, S.Pd\u003c/option\u003e\n      \u003coption\u003eELY YULIASARI, S.S\u003c/option\u003e\n      \u003coption\u003eIIS SARININGSIH, S.Pd\u003c/option\u003e\n      \u003coption\u003eYULI WIDIA, S.Pd\u003c/option\u003e\n      \u003coption\u003eDEDE SULAEMAN, S.Pd\u003c/option\u003e\n      \u003coption\u003eRIKA PAULINA DEWI, S.Pd\u003c/option\u003e\n      \u003coption\u003eSANDI WIJAYA, S.Pd\u003c/option\u003e\n      \u003coption\u003eADE ATIN, S.Pd.I\u003c/option\u003e\n      \u003coption\u003eUMAS SOLIHAH, S.Ag\u003c/option\u003e\n      \u003coption\u003eKARTIKA HADI, M.Pd\u003c/option\u003e\n      \u003coption\u003eANI MARTINI, S.Pd\u003c/option\u003e\n      \u003coption\u003eDESSY SRIKANDI, S.Pd\u003c/option\u003e\n      \u003coption\u003eSITA PARLIANI SUHERLAN, S.Pd\u003c/option\u003e\n      \u003coption\u003eNATYA ADI PUTRI, S.Sn\u003c/option\u003e\n      \u003coption\u003eAYU SRI YUNINGSIH, S.Pd\u003c/option\u003e\n      \u003coption\u003eENI NURAENI, S.Pd\u003c/option\u003e\n      \u003coption\u003eMERYTA SRI RAHAYU, S.Pd\u003c/option\u003e\n      \u003coption\u003eNISA NAILUFAR UMAMI, S.Pd\u003c/option\u003e\n      \u003coption\u003eHADISTIA SITI NURYANI, S.Pd\u003c/option\u003e\n      \u003coption\u003eLIZHARA DELANIS, S.Pd\u003c/option\u003e\n      \u003coption\u003eYUYUN YUNENGSIH, S.Pd\u003c/option\u003e\n      \u003coption\u003eGHAISANI FILDZAH AMAJIDA, S.Pd\u003c/option\u003e\n      \u003coption\u003eDIKDIK DWIYANTO, S.Pd\u003c/option\u003e\n      \u003coption\u003eHABIBURRAHMAN, S.Pd\u003c/option\u003e\n      \u003c/select\u003e\n\n      \u003clabel\u003eJabatan:\u003c/label\u003e\n      \u003cselect id\u003d\"jabatan\"\u003e\n        \u003coption value\u003d\"\"\u003e-- Pilih Jabatan --\u003c/option\u003e\n        \u003coption\u003eGuru\u003c/option\u003e\n        \u003coption\u003eStaf TU\u003c/option\u003e\n        \u003coption\u003eKepala Sekolah\u003c/option\u003e\n      \u003c/select\u003e\n\n      \u003clabel\u003eMengajar di Kelas:\u003c/label\u003e\n      \u003cselect id\u003d\"kelas\"\u003e\n        \u003coption value\u003d\"\"\u003e-- Pilih Kelas --\u003c/option\u003e\n        \u003coption\u003e7A\u003c/option\u003e\u003coption\u003e7B\u003c/option\u003e\u003coption\u003e7C\u003c/option\u003e\n        \u003coption\u003e7D\u003c/option\u003e\u003coption\u003e7E\u003c/option\u003e\u003coption\u003e7F\u003c/option\u003e\n        \u003coption\u003e7G\u003c/option\u003e\u003coption\u003e7H\u003c/option\u003e\u003coption\u003e7I\u003c/option\u003e\n        \u003coption\u003e7J\u003c/option\u003e\u003coption\u003e7K\u003c/option\u003e\u003coption\u003e8A\u003c/option\u003e\n        \u003coption\u003e8B\u003c/option\u003e\u003coption\u003e8C\u003c/option\u003e\u003coption\u003e8D\u003c/option\u003e\n        \u003coption\u003e8E\u003c/option\u003e\u003coption\u003e8F\u003c/option\u003e\u003coption\u003e8G\u003c/option\u003e\n        \u003coption\u003e8H\u003c/option\u003e\u003coption\u003e8I\u003c/option\u003e\u003coption\u003e8J\u003c/option\u003e\n        \u003coption\u003e8K\u003c/option\u003e\u003coption\u003e9A\u003c/option\u003e\u003coption\u003e9B\u003c/option\u003e\n        \u003coption\u003e9C\u003c/option\u003e\u003coption\u003e9D\u003c/option\u003e\u003coption\u003e9E\u003c/option\u003e\n        \u003coption\u003e9F\u003c/option\u003e\u003coption\u003e9G\u003c/option\u003e\u003coption\u003e9H\u003c/option\u003e\n        \u003coption\u003e9I\u003c/option\u003e\u003coption\u003e9J\u003c/option\u003e\u003coption\u003e9K\u003c/option\u003e\n      \u003c/select\u003e\n\n      \u003clabel\u003eJam Ke-:\u003c/label\u003e\n      \u003cselect id\u003d\"jam\"\u003e\n        \u003coption value\u003d\"\"\u003e-- Pilih Jam --\u003c/option\u003e\n        \u003coption\u003e1\u003c/option\u003e\u003coption\u003e2\u003c/option\u003e\u003coption\u003e3\u003c/option\u003e\n        \u003coption\u003e4\u003c/option\u003e\u003coption\u003e5\u003c/option\u003e\u003coption\u003e6\u003c/option\u003e\n        \u003coption\u003e7\u003c/option\u003e\u003coption\u003e8\u003c/option\u003e\u003coption\u003e9\u003c/option\u003e\n      \u003c/select\u003e\n\n      \u003clabel\u003eLokasi (otomatis):\u003c/label\u003e\n      \u003cinput type\u003d\"text\" id\u003d\"lokasi\" readonly\u003e\n\n      \u003clabel\u003eTanda Tangan:\u003c/label\u003e\n      \u003ccanvas id\u003d\"signature\" width\u003d\"300\" height\u003d\"150\"\u003e\u003c/canvas\u003e\n\n      \u003cdiv class\u003d\"button-group\"\u003e\n        \u003cbutton onclick\u003d\"clearCanvas()\"\u003eHapus Tanda Tangan\u003c/button\u003e\n        \u003cbutton onclick\u003d\"submitData()\"\u003eKirim Absensi\u003c/button\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\n    \u003cdiv class\u003d\"footer\"\u003e\u0026copy; 2025 SMP Negeri 4 Subang\u003c/div\u003e\n\n    \u003cscript\u003e\n      navigator.geolocation.getCurrentPosition(function(position) {\n        document.getElementById(\"lokasi\").value \u003d\n          position.coords.latitude + \",\" + position.coords.longitude;\n      });\n\n      const canvas \u003d document.getElementById(\u0027signature\u0027);\n      const ctx \u003d canvas.getContext(\u00272d\u0027);\n      let drawing \u003d false;\n\n      // Event mouse\n      canvas.addEventListener(\u0027mousedown\u0027, () \u003d\u003e drawing \u003d true);\n      canvas.addEventListener(\u0027mouseup\u0027, () \u003d\u003e {\n        drawing \u003d false;\n        ctx.beginPath();\n      });\n      canvas.addEventListener(\u0027mousemove\u0027, drawMouse);\n\n      function drawMouse(e) {\n        if (!drawing) return;\n        const rect \u003d canvas.getBoundingClientRect();\n        ctx.lineWidth \u003d 2;\n        ctx.lineCap \u003d \"round\";\n        ctx.strokeStyle \u003d \"#000\";\n        ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);\n        ctx.stroke();\n        ctx.beginPath();\n        ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);\n      }\n\n      // Event sentuhan\n      canvas.addEventListener(\u0027touchstart\u0027, function(e) {\n        e.preventDefault();\n        drawing \u003d true;\n      });\n\n      canvas.addEventListener(\u0027touchend\u0027, function(e) {\n        drawing \u003d false;\n        ctx.beginPath();\n      });\n\n      canvas.addEventListener(\u0027touchmove\u0027, function(e) {\n        if (!drawing) return;\n        const rect \u003d canvas.getBoundingClientRect();\n        const touch \u003d e.touches[0];\n        const x \u003d touch.clientX - rect.left;\n        const y \u003d touch.clientY - rect.top;\n\n        ctx.lineWidth \u003d 2;\n        ctx.lineCap \u003d \"round\";\n        ctx.strokeStyle \u003d \"#000\";\n        ctx.lineTo(x, y);\n        ctx.stroke();\n        ctx.beginPath();\n        ctx.moveTo(x, y);\n      });\n\n      function clearCanvas() {\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n      }\n\n      function submitData() {\n        const nama \u003d document.getElementById(\"nama\").value;\n        const jabatan \u003d document.getElementById(\"jabatan\").value;\n        const kelas \u003d document.getElementById(\"kelas\").value;\n        const jam \u003d document.getElementById(\"jam\").value;\n        const lokasi \u003d document.getElementById(\"lokasi\").value;\n        const ttdUrl \u003d canvas.toDataURL();\n\n        if (!nama || !jabatan || !kelas || !jam || !lokasi) {\n          alert(\"Mohon lengkapi semua isian sebelum mengirim!\");\n          return;\n        }\n\n        google.script.run.withSuccessHandler(msg \u003d\u003e {\n          alert(msg);\n          document.getElementById(\"nama\").value \u003d \"\";\n          document.getElementById(\"jabatan\").value \u003d \"\";\n          document.getElementById(\"kelas\").value \u003d \"\";\n          document.getElementById(\"jam\").value \u003d \"\";\n          clearCanvas();\n        }).saveData({ nama, jabatan, kelas, jam, lokasi, ttdUrl });\n      }\n    \u003c/script\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n"}]}